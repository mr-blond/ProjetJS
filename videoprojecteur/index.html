<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Test affichage goutelette</title>
    <script src="js\lib/jquery.js"></script>
  <script src="js/polifill.js"></script>
    <script src="js/lib/Box2dWeb-2.1.a.3.min.js"></script>
    <script src="js/class/Box2DWrapper.js"></script>
    <script src="js/class/Debuger.js"></script>
    <script src="js/class/GenerateurGouttelette.js"></script>
    <script src="js/class/Gouttelette.js"></script>
    <script src="js/class/Palier.js"></script>
    <script src="js/class/Level.js"></script>
    <script src="js/class/Fluide.js"></script>
    <script src="js/main.js"></script>
    <script src="http://localhost:8080/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body onload="init();">
    <div id="displayDataPallierFromServ"> </div>
    <div id="displayDataRotationFromServ"> </div>
    <canvas id="canvasPalier"></canvas>
    <canvas id="canvasGoutte"></canvas>
    <canvas id="canvasDebug"></canvas>

   <script>
    //ICI ecouter les événements envoyés par le serveur pour modifier la position des paliers

$(function() {
   // Connexion à socket.io
                var socket = io.connect('http://localhost:8080');
                var mustTurn = 4;
                socket.on('onTargetMove', function(data) {
                    $('#displayDataPallierFromServ').html('<p> changement de position : ' + data.id + ' - ' + data.x + ' - ' + data.y  + ' - ' + data.rotation + '</p>');

                    Palier.move(data.id, data.x, data.y, data.rotation);

                    if(data.id !== mustTurn){
                        mustTurn = data.id;
                        var infoServo = {'pos':mustTurn*40,'pin':12};
                        socket.emit('servo', infoServo); // Transmet le message aux autres
                    }
                });

                socket.on('stageRotation', function(data) {
                    $('#displayDataRotationFromServ').html('<p> rotation de la tablette : ' +  data.rotation + '</p>');
                        console.log('stageRotation : ' + data.rotation)
                
                });
                
              console.log('endScript');  
});
               
        </script>
</body>
</html>